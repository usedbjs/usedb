(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{112:function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return m}));var a=n(0),r=n.n(a);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function p(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var c=r.a.createContext({}),u=function(e){var t=r.a.useContext(c),n=t;return e&&(n="function"==typeof e?e(t):l(l({},t),e)),n},s=function(e){var t=u(e.components);return r.a.createElement(c.Provider,{value:t},e.children)},b={inlineCode:"code",wrapper:function(e){var t=e.children;return r.a.createElement(r.a.Fragment,{},t)}},d=r.a.forwardRef((function(e,t){var n=e.components,a=e.mdxType,i=e.originalType,o=e.parentName,c=p(e,["components","mdxType","originalType","parentName"]),s=u(n),d=a,m=s["".concat(o,".").concat(d)]||s[d]||b[d]||i;return n?r.a.createElement(m,l(l({ref:t},c),{},{components:n})):r.a.createElement(m,l({ref:t},c))}));function m(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var i=n.length,o=new Array(i);o[0]=d;var l={};for(var p in t)hasOwnProperty.call(t,p)&&(l[p]=t[p]);l.originalType=e,l.mdxType="string"==typeof e?e:a,o[1]=l;for(var c=2;c<i;c++)o[c]=n[c];return r.a.createElement.apply(null,o)}return r.a.createElement.apply(null,n)}d.displayName="MDXCreateElement"},78:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return o})),n.d(t,"metadata",(function(){return l})),n.d(t,"toc",(function(){return p})),n.d(t,"default",(function(){return u}));var a=n(3),r=n(7),i=(n(0),n(112)),o={id:"security",title:"Security",sidebar_label:"Security"},l={unversionedId:"laravel/security",id:"laravel/security",isDocsHomePage:!1,title:"Security",description:"Authentication",source:"@site/docs/laravel/security.md",slug:"/laravel/security",permalink:"/usedb/docs/laravel/security",version:"current",sidebar_label:"Security",sidebar:"someSidebar",previous:{title:"Middleware",permalink:"/usedb/docs/laravel/middleware"},next:{title:"Relationships",permalink:"/usedb/docs/laravel/relationships"}},p=[{value:"Authentication",id:"authentication",children:[]},{value:"Authorization",id:"authorization",children:[]}],c={toc:p};function u(e){var t=e.components,n=Object(r.a)(e,["components"]);return Object(i.b)("wrapper",Object(a.a)({},c,n,{components:t,mdxType:"MDXLayout"}),Object(i.b)("h2",{id:"authentication"},"Authentication"),Object(i.b)("p",null,"For adding authentication, first, you need to install any authentication service in your Laravel app and then add the provided by it in the middleware group of usedb."),Object(i.b)("p",null,"For instance, if you install ",Object(i.b)("a",Object(a.a)({parentName:"p"},{href:"https://jetstream.laravel.com/2.x/introduction.html"}),"Jetstream")," as an authentication service, the middleware provided by Jetstream is ",Object(i.b)("inlineCode",{parentName:"p"},"auth:sanctum")," so you need to add it in the middleware group in the config file as shown."),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{className:"language-php",metastring:'title="usedb.php"',title:'"usedb.php"'}),"'middleware' => [\n        'usedb',\n        'model-usedb',\n        \"auth:sanctum\",\n]\n")),Object(i.b)("h2",{id:"authorization"},"Authorization"),Object(i.b)("p",null,"Authorization can be done in two ways: Gates and Policies. After creating them, you need to mention them in the usedb config file."),Object(i.b)("ol",null,Object(i.b)("li",{parentName:"ol"},Object(i.b)("strong",{parentName:"li"},"Gates"),": To map a gate to a particular operation of a model, you have to define it in the gates property of type array in the permissions field.\nSyntax:")),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{className:"language-php"}),"'gates' => [\n        'modelName' => [\n        'update' => [],\n        'delete' => [],\n        'create' => [],\n        'findOne' => [],\n        'findMany' => []\n    ]\n]\n")),Object(i.b)("p",null,"modelName represents the name of the model in which you want to apply gates. ",Object(i.b)("inlineCode",{parentName:"p"},"update"),", ",Object(i.b)("inlineCode",{parentName:"p"},"delete"),", ",Object(i.b)("inlineCode",{parentName:"p"},"create"),", ",Object(i.b)("inlineCode",{parentName:"p"},"findOne"),", and ",Object(i.b)("inlineCode",{parentName:"p"},"findMany")," map the array of gates to be applied to their respective operations."),Object(i.b)("p",null,Object(i.b)("strong",{parentName:"p"},"Example")),Object(i.b)("p",null,"We have a Blog model and we need to define a gate for its update and delete operation."),Object(i.b)("p",null,"i) Defining gate in your app"),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{className:"language-php"}),"Gate::define('update-delete-blog', function (User $user, Post $post) {\n    return $user->id == $post->user_id;\n});\n\nGate::define('demo', function (User $user, Post $post) {\n    return $user->id == $post->user_id;\n});\n")),Object(i.b)("p",null,"ii) Mapping gates"),Object(i.b)("p",null,"usedb.php"),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{className:"language-jsx"}),"'permissions' => [\n                'gates' => [\n            'Blog' => [\n                'update' => ['update-delete-blog', 'demo'],\n                'delete' => ['update-delete-blog'],\n            ]\n        ],\n\n        'policies' => [\n        ],\n]\n")),Object(i.b)("ol",{start:2},Object(i.b)("li",{parentName:"ol"},Object(i.b)("strong",{parentName:"li"},"Policy"),": To apply a policy to a certain operation of a particular model, you have to define it in the ",Object(i.b)("inlineCode",{parentName:"li"},"policies")," property of type array in the ",Object(i.b)("inlineCode",{parentName:"li"},"permissions")," field.\nThe syntax for the same:")),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{className:"language-php"}),"'policies' => [\n        'modelName' => [\n                'update' => '',\n        'delete' => '',\n        'create' => '',\n        'findOne' => '',\n        'findMany' => ''\n    ]\n]\n")),Object(i.b)("p",null,"modelName represents the name of the model in which you want to apply policies. ",Object(i.b)("inlineCode",{parentName:"p"},"update"),", ",Object(i.b)("inlineCode",{parentName:"p"},"delete"),", ",Object(i.b)("inlineCode",{parentName:"p"},"create"),", ",Object(i.b)("inlineCode",{parentName:"p"},"findOne"),", and ",Object(i.b)("inlineCode",{parentName:"p"},"findMany")," maps to the policy to be applied to their respective operations."),Object(i.b)("p",null,Object(i.b)("strong",{parentName:"p"},"Example")),Object(i.b)("p",null,"We have a model Blog."),Object(i.b)("p",null,"i) Defining a policy BlogPolicy for Blog:"),Object(i.b)("p",null,"BlogPolicy.php"),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{className:"language-php"}),"class BlogPolicy\n{\n    use HandlesAuthorization;\n\n        public function update(User $user, Blog $blog)\n    {\n        return $user->id === $blog->user_id;\n    }\n\n    public function delete(User $user, Blog $blog)\n    {\n        return false;\n    }\n}\n")),Object(i.b)("p",null,"ii) Mapping Policies"),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{className:"language-php"}),"'permissions' => [\n        'gates' => [\n        ],\n\n        'policies' => [\n                    'Blog' => [\n                'update' => 'update',\n                'create' => 'create',\n              ]\n        ],\n]\n")))}u.isMDXComponent=!0}}]);